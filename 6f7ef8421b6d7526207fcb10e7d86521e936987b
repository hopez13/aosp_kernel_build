{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "b6734b19_3b2c49cb",
        "filename": "kleaf/impl/kernel_env.bzl",
        "patchSetId": 2
      },
      "lineNbr": 279,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2024-10-15T21:13:33Z",
      "side": 1,
      "message": "Sorry for the misleading comment; could you please move it to here instead?\n\n`toolchains_setup_env_var_cmd` is where HOSTCFLAGS etc. are set.",
      "revId": "6f7ef8421b6d7526207fcb10e7d86521e936987b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c4079160_6affc477",
        "filename": "kleaf/impl/kernel_env.bzl",
        "patchSetId": 2
      },
      "lineNbr": 295,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2024-10-15T21:13:33Z",
      "side": 1,
      "message": "Do you need to check if this variable is actually set?\n\nAlso, consider deleting L155 and change this to {quoted_rust_bin}/../lib64 directly, e.g.\n\n```\nif [[ -n \"$KLEAF_INTERNAL_RUST_PREBUILT_BIN\" ]];\n    export HOSTRUSTFLAGS\u003d...\nfi\n```",
      "range": {
        "startLine": 295,
        "startChar": 68,
        "endLine": 295,
        "endChar": 96
      },
      "revId": "6f7ef8421b6d7526207fcb10e7d86521e936987b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5dda67fa_208fb1b0",
        "filename": "kleaf/impl/kernel_env.bzl",
        "patchSetId": 2
      },
      "lineNbr": 295,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2024-10-15T21:17:26Z",
      "side": 1,
      "message": "Actually, I think using ${ROOT_DIR} here is problematic. The issue is that the runpath is embedded in the built binary, making the binary non-portable \u0026 non-reproducible.\n\nThe C toolchain resolved it with this trick:\n\nhttps://android-review.git.corp.google.com/c/kernel/build/+/3134393/9/kleaf/impl/kernel_toolchains.bzl\n\n(to avoid using $ROOT_DIR in runpaths).\n\nI am okay to submit this for now, but please file a bug so we clean up the `-Wl,-rpath,${ROOT_DIR}` here. We should use $ORIGIN instead to make the binaries reproducible.",
      "parentUuid": "c4079160_6affc477",
      "range": {
        "startLine": 295,
        "startChar": 68,
        "endLine": 295,
        "endChar": 96
      },
      "revId": "6f7ef8421b6d7526207fcb10e7d86521e936987b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0e2fe5fc_e93469e1",
        "filename": "kleaf/impl/kernel_env.bzl",
        "patchSetId": 2
      },
      "lineNbr": 593,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2024-10-15T21:13:33Z",
      "side": 1,
      "message": "Same here",
      "revId": "6f7ef8421b6d7526207fcb10e7d86521e936987b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2a63aaf7_0b384c08",
        "filename": "kleaf/impl/kernel_env.bzl",
        "patchSetId": 2
      },
      "lineNbr": 593,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2024-10-15T21:13:53Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "0e2fe5fc_e93469e1",
      "revId": "6f7ef8421b6d7526207fcb10e7d86521e936987b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}